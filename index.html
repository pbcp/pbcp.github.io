<!DOCTYPE html>
<html>
<head>
	<title></title>
	<meta charset="utf-8">
	<style type="text/css">
		body {
			font: 10pt/16pt monospace;
			color: hsl(230, 8%, 24%);
			background: #FAFAFA;
			margin: 0;
		}
		pre {
			font-family: "Menlo", monospace;
			margin: 0;
		}
		pre:after {
			content: " ";
			background: hsl(221, 87%, 60%);
		}
	</style>
</head>
<body>
<pre id="tty"></pre>
<script type="text/javascript">
var input = [{
	text: ["11:12:16 "],
	style: "color: hsl(301, 63%, 40%)",
	delay: 0
},{
	text: ["~ "],
	style: "color: hsl(198, 99%, 37%)",
	delay: 0
},{
	text: ["→ "],
	style: "color: hsl(5, 74%, 59%)",
	delay: 0
},{
	text: "echo ",
	style: "color: hsl(119, 34%, 47%)",
	delay: 600
},{
	text: "\"Hello world\\!\" ",
	style: "color: hsl(41, 99%, 30%)"
},{
	text: "| "
},{
	text: "pbc\n",
	style: "color: hsl(119, 34%, 47%)"
},{
	text: ["11:12:16 "],
	style: "color: hsl(301, 63%, 40%)",
	delay: 0
},{
	text: ["~ "],
	style: "color: hsl(198, 99%, 37%)",
	delay: 0
},{
	text: ["→ "],
	style: "color: hsl(5, 74%, 59%)",
	delay: 0
},{
	text: "ssh ",
	style: "color: hsl(119, 34%, 47%)",
	delay: 800
},{
	text: "root@vm\n"
},{
	text: ["Last login: Sun Mar 27 11:04:28 2016 from 192.168.64.1\n"],
	delay: 600
},{
	text: ["@vm "],
	style: "color: hsl(198, 99%, 37%)",
	delay: 200
},{
	text: ["11:12:16 "],
	style: "color: hsl(301, 63%, 40%)",
	delay: 0
},{
	text: ["~ "],
	style: "color: hsl(198, 99%, 37%)",
	delay: 0
},{
	text: ["→ "],
	style: "color: hsl(5, 74%, 59%)",
	delay: 0
},{
	text: "pbp\n",
	style: "color: hsl(119, 34%, 47%)",
	delay: 800
},{
	text: ["Hello world!\n"],
	delay: 200
},{
	text: ["@vm "],
	style: "color: hsl(198, 99%, 37%)",
	delay: 0
},{
	text: ["11:12:16 "],
	style: "color: hsl(301, 63%, 40%)",
	delay: 0
},{
	text: ["~ "],
	style: "color: hsl(198, 99%, 37%)",
	delay: 0
},{
	text: ["→ "],
	style: "color: hsl(5, 74%, 59%)",
	delay: 0
},{
	text: [],
	clear: true,
	delay: 5000
},{
	text: "hello world!"
}];

var target = document.getElementById("tty");
var delay = 80;

function nextStage(i) {
	if (i >= input.length) {
		setTimeout(function () {
			while (target.lastChild) target.removeChild(target.lastChild);
			nextStage(0);
		}, 5000);
		return;
	}
	var span = document.createElement("span");
	target.appendChild(span);
	var j = 0;
	var stage = input[i];
	var d = delay * (2.5 + Math.random());

	if (typeof(stage) == "object") {
		if (stage.clear) {
			setTimeout(function () {
				while (target.lastChild) target.removeChild(target.lastChild);
				nextStage(++i);
			}, stage.delay || 0);
			return;
		}
		if (stage.style)
			span.setAttribute("style", stage.style);
		if (stage.delay != undefined)
			d = stage.delay;

		stage = stage.text;
	}

	if (d > 0)
		setTimeout(nextPart.bind(this, stage, span, i, j), d);
	else
		nextPart(stage, span, i, j);
}

function nextPart(stage, span, i, j) {
	if (j >= stage.length) return nextStage(++i);
	var part = stage[j];
	var d = (j == stage.length - 1) ? 0 : delay;
	span.textContent += part;

	if (d > 0)
		setTimeout(nextPart.bind(this, stage, span, i, ++j), d * (0.5 + Math.random()));
	else
		nextPart(stage, span, i, ++j);
}

nextStage(0);
</script>
</body>
</html>